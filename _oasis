OASISFormat: 0.4
OCamlVersion: >= 4.04.0
Name:        frenetic
Version:     4.0.0
Synopsis:    The Frenetic Compiler and Runtime System
Authors:     https://github.com/frenetic-lang/frenetic/contributors
License:     LGPL
Plugins:     META (0.4)
BuildTools:
  ocamlbuild,
  ocamldoc,
  menhir,
  cppo
BetaFeatures:
  findlib_extra_files
AlphaFeatures:
  ocamlbuild_more_args,
  source_patterns
XOCamlbuildExtraArgs:
  -use-menhir
  # see https://caml.inria.fr/pub/docs/manual-ocaml/native.html
  -cflags -w,@5+8@11@12-40,-short-paths

# generate standard parser, syntax extension parser, and tokens from common file
PreBuildCommand:
  cppo -n \
    lib/Frenetic_NetKAT_Generated_Parser.cppo.mly \
    -o lib/Frenetic_NetKAT_Generated_Parser.mly
  cppo -n \
    ppx/PPX_NetKAT_Parser.cppo.mly \
    -o ppx/PPX_NetKAT_Parser.mly
  menhir --only-tokens ppx/PPX_NetKAT_Parser.mly \
    --base lib/Frenetic_NetKAT_Tokens
PostBuildCommand:
  rm -f ppx/PPX_NetKAT_Parser.mly
  rm -f lib/Frenetic_NetKAT_Generated_Parser.mly
  # do not delete so ocamldoc is happy!
  # rm -f lib/Frenetic_NetKAT_Tokens*
ImplementationPatterns:
  ${module}.cppo.mly

Library frenetic
  Path: lib
  Findlibname: frenetic
  BuildDepends:
    base64 (>= 2.0.0),
    core,
    cstruct (>= 3.0.2),
    cstruct.ppx,
    ocamlgraph (>= 1.8.7),
    str,
    tcpip,
    tcpip.unix,
    yojson,
    ipaddr,
    ppx_deriving.std,
    ppx_compare,
    ppx_enumerate,
    ppx_hash,
    ppx_fields_conv,
    ppx_type_conv,
    ppx_sexp_conv,
    sexplib,
    sedlex,
    menhirLib,
    threads,
    compiler-libs.common
  InternalModules:
    LexBuffer,
    Frenetic_NetKAT_Lexer,
    Frenetic_NetKAT_Generated_Parser
  Modules:
    Frenetic_Hashcons,
    Frenetic_Bits,
    Frenetic_Fdd,
    Frenetic_OpenFlow0x04,
    Frenetic_GroupTable0x04,
    Frenetic_NetKAT,
    Frenetic_NetKAT_Tokens,
    Frenetic_NetKAT_Parser,
    Frenetic_NetKAT_Optimize,
    Frenetic_NetKAT_Json,
    Frenetic_NetKAT_Compiler,
    Frenetic_NetKAT_FabricGen,
    Frenetic_NetKAT_Virtual_Compiler,
    Frenetic_NetKAT_Net,
    Frenetic_NetKAT_Pretty,
    Frenetic_NetKAT_Semantics,
    Frenetic_Network,
    Frenetic_OpenFlow,
    Frenetic_OpenFlow_Header,
    Frenetic_OpenFlow0x01,
    Frenetic_Packet,
    Frenetic_Topology,
    Frenetic_Util,
    Frenetic_Vlr

Executable nominal
  Install: false
  Path: nominal
  MainIs: nominal.ml
  BuildDepends:
    core,
    threads,
    frenetic,
    ppx_deriving.std,
    ppx_deriving_yojson,
    ppx_hash
